<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Special Request üíñ</title>

  <!-- Responsive + font + theme color -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <meta name="theme-color" content="#ff758c" />

  <style>
    :root{
      --pink-1: #ff758c;
      --pink-2: #ff7eb3;
      --accent: #ff4d6d;
      --card-bg: rgba(255,255,255,0.14);
    }

    html,body{
      height:100%;
      margin:0;
      font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: #fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      background: linear-gradient(135deg, var(--pink-1), var(--pink-2));
    }

    body{
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      padding:2rem;
    }

    .card {
      background: var(--card-bg);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      padding: 3.5rem 4.5rem;
      border-radius: 2.2rem;
      text-align: center;
      box-shadow: 0 20px 40px rgba(0,0,0,0.35);
      max-width: 520px;
      width:100%;
      position:relative;
      z-index: 2;
      transform: translateZ(0);
    }

    h1{
      font-size: clamp(1.4rem, 2.5vw, 2.4rem);
      margin:0 0 1.2rem;
      line-height:1.1;
    }

    p{
      font-size: clamp(1rem, 2vw, 1.15rem);
      margin:0 0 1.8rem;
    }

    .buttons {
      display:flex;
      gap:1.5rem;
      justify-content:center;
      flex-wrap:wrap;
    }

    button{
      border:none;
      padding: .9rem 2.4rem;
      border-radius: 40px;
      font-size: 1.05rem;
      cursor:pointer;
      transition: transform .18s cubic-bezier(.2,.9,.3,1), box-shadow .18s;
      will-change: transform;
      font-weight:600;
    }

    button:focus{
      outline: 3px solid rgba(255,255,255,0.22);
      outline-offset: 4px;
    }

    .primary{
      background: var(--accent);
      color: #fff;
      box-shadow: 0 6px 18px rgba(0,0,0,0.28);
    }
    .primary:active{ transform: scale(.98); }

    .no{
      background: #fff;
      color: var(--accent);
      position:relative;
      min-width: 9ch;
    }

    .no:hover{ transform: translateY(-3px); }

    /* Floating hearts container (behind cards) */
    .hearts {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      overflow: visible;
    }

    .heart {
      position: absolute;
      bottom: -40px;
      font-size: 20px;
      will-change: transform, opacity;
      animation: float linear infinite;
      opacity: 0.95;
      transform-origin: center;
    }

    @keyframes float {
      from { transform: translateY(0) rotate(0deg); opacity: 1; }
      to   { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
    }

    /* Popup - styled like the cards (same look) */
    .popup {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      visibility: hidden;
      justify-content: center;
      align-items: center;
      z-index: 10;
      padding: 1.25rem;
    }

    .popup-content {
      /* Use same treatment as .card for consistent colour/look */
      background: var(--card-bg);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      color:#fff;
      padding: 3.5rem 4rem;
      border-radius: 2rem;
      text-align:center;
      animation: pop .6s ease;
      max-width: 520px;
      width:100%;
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
      position:relative;
      border: 1px solid rgba(255,255,255,0.06);
    }

    @keyframes pop {
      from { transform: scale(.92); opacity: 0; }
      to   { transform: scale(1); opacity: 1; }
    }

    .popup-content h2{
      font-size: clamp(1.6rem, 3vw, 2.6rem);
      margin:0 0 1rem;
      font-weight:700;
    }
    .popup-content p{ margin:0; font-size:1.1rem; line-height:1.6; }

    .popup-close {
      position:absolute;
      right: 14px;
      top: 12px;
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.95);
      font-size:1.35rem;
      cursor:pointer;
    }

    /* minimal accepted screen */
    .accepted {
      display:none;
      max-width:520px;
      width:100%;
      text-align:center;
    }

    @supports not ((-webkit-backdrop-filter: blur(10px)) or (backdrop-filter: blur(10px))) {
      .card, .popup-content { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04)); }
    }

    @media (max-width:420px){
      .card { padding:2rem; border-radius:1.25rem; }
      .popup-content { padding:2rem; border-radius:1rem; }
    }

    /* Respect reduced motion for users who request it */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
      .heart { display:none; }
    }
  </style>
</head>

<body>

  <!-- Hearts (decorative, behind cards) -->
  <div class="hearts" id="hearts"></div>

  <!-- SCREEN 1 -->
  <div class="card" id="screen1" aria-hidden="false">
    <h1>üíå New Request</h1>
    <p>You have a request from<br><strong>Mrs. Afraz</strong></p>
    <button type="button" class="primary" id="viewRequestBtn" aria-label="View request">View Request üíñ</button>
  </div>

  <!-- SCREEN 2 -->
  <div class="card" id="screen2" style="display:none;" aria-hidden="true">
    <h1>
      Will you be my Valentine,<br>
      <span>‚ù§Ô∏è Mr Afraz ‚ù§Ô∏è</span>?
    </h1>

    <div class="buttons">
      <button type="button" class="primary" id="yesBtn" aria-label="Say yes">YES üíñ</button>
      <button type="button" class="no" id="noBtn" aria-label="Say no">NO üòà</button>
    </div>
  </div>

  <!-- minimal ACCEPTED screen (shown after popup closes when accepted) -->
  <div class="card accepted" id="acceptedScreen" aria-hidden="true">
    <h1>We're together üíç</h1>
    <p>You're always my Valentine ‚Äî today, tomorrow, and forever üíñ</p>
  </div>

  <!-- POPUP -->
  <div class="popup" id="popup" role="dialog" aria-modal="true" aria-labelledby="popupTitle" tabindex="-1">
    <div class="popup-content" role="document">
      <button class="popup-close" id="popupClose" aria-label="Close popup">‚úï</button>
      <h2 id="popupTitle">Aww honey ü•∞üíï</h2>
      <p>
        <span class="line">You're always my Valentine üíç</span><br/>
        <span class="line">Today, tomorrow, and forever üíñ</span>
      </p>
    </div>
  </div>

  <!-- Confetti lib (optional, small CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" async></script>

  <script>
    // Elements
    const screen1 = document.getElementById('screen1');
    const screen2 = document.getElementById('screen2');
    const acceptedScreen = document.getElementById('acceptedScreen');
    const viewRequestBtn = document.getElementById('viewRequestBtn');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const popup = document.getElementById('popup');
    const popupClose = document.getElementById('popupClose');
    const heartsContainer = document.getElementById('hearts');

    // Local (in-memory) state only ‚Äî refresh resets everything
    let acceptedInMemory = false;
    let noClickIndex = 0;

    // ~50 "no" messages (looping)
    const noTexts = [
      'NO üòà',
      'Really? ü§î',
      'Are you sure? üò¢',
      'Think again! üíî',
      'Please? ü•∫',
      'One more chance? üíï',
      'Final answer? üò≠',
      'You break my heart üíî',
      "Not today üò¨",
      "Stop it üòí",
      "Nope. Nope. Nope.",
      "Come on... üôÑ",
      "I can't... üòû",
      "This is tragic üò¢",
      "The answer is no.",
      "Hard pass.",
      "Please don't.",
      "Ugh, seriously?",
      "Not in a million years.",
      "Try again later.",
      "Maybe never.",
      "I'm devastated.",
      "Why would I?",
      "That's a hard no.",
      "Sad face üò≠",
      "My feelings ‚Äî crushed.",
      "Cold heart üíî",
      "No way Jos√©.",
      "Absolutely not.",
      "Negative.",
      "Declined.",
      "Access denied.",
      "Not happening.",
      "I refuse.",
      "No thanks.",
      "Think twice.",
      "Still no.",
      "No. Stop.",
      "Do you even listen?",
      "Oh, come on...",
      "Why though?",
      "This hurts.",
      "My answer stays no.",
      "Please reconsider.",
      "This is awkward.",
      "My heart says no.",
      "Can't pretend to be okay with that.",
      "I'm allergic to yes.",
      "Sadder than ever.",
      "Echo: no.",
      "Cry me a river."
    ];

    // Hearts / decorations
    let heartInterval = null;
    function createHeart(){
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.textContent = '‚ù§Ô∏è';
      const left = Math.random() * 100;
      heart.style.left = left + 'vw';
      const size = 14 + Math.random() * 28;
      heart.style.fontSize = size + 'px';
      const duration = 4 + Math.random() * 5;
      heart.style.animationDuration = duration + 's';
      heart.style.opacity = 0.9 - Math.random() * 0.5;
      heartsContainer.appendChild(heart);
      setTimeout(() => heart.remove(), duration * 1000);
    }

    function startHearts(){
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      if (!heartInterval) heartInterval = setInterval(createHeart, 350);
    }
    function stopHearts(){
      if (heartInterval) { clearInterval(heartInterval); heartInterval = null; }
      heartsContainer.querySelectorAll('.heart').forEach(h => h.remove());
    }

    // Show the valentine screen
    function showValentine(){
      screen1.style.display = 'none';
      screen1.setAttribute('aria-hidden', 'true');
      screen2.style.display = 'block';
      screen2.setAttribute('aria-hidden', 'false');
      startHearts();
      requestAnimationFrame(()=> yesBtn.focus());
    }

    // Popup open/close
    function showPopup(){
      popup.style.display = 'flex';
      popup.style.visibility = 'visible';
      popup.setAttribute('aria-hidden', 'false');
      stopHearts();

      if (window.confetti && typeof window.confetti === 'function') {
        confetti({ particleCount: 120, spread: 80, origin: { y: 0.35 } });
      }

      // mark accepted only in-memory (no persistence)
      acceptedInMemory = true;

      popup.focus();
    }

    function closePopup(){
      popup.style.display = 'none';
      popup.style.visibility = 'hidden';
      popup.setAttribute('aria-hidden', 'true');

      if (acceptedInMemory) {
        // show accepted message (in-memory only)
        screen1.style.display = 'none';
        screen1.setAttribute('aria-hidden', 'true');
        screen2.style.display = 'none';
        screen2.setAttribute('aria-hidden', 'true');
        acceptedScreen.style.display = 'block';
        acceptedScreen.setAttribute('aria-hidden', 'false');
      } else {
        if (screen2.style.display === 'block') yesBtn.focus();
      }
    }

    // NO button: change text on click, loop through array
    noBtn.addEventListener('click', () => {
      noClickIndex = (noClickIndex + 1) % noTexts.length;
      noBtn.textContent = noTexts[noClickIndex];
    });

    // ESC to close popup & click outside to close
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && popup.style.display === 'flex') {
        closePopup();
      }
    });

    popup.addEventListener('click', (e) => {
      const content = popup.querySelector('.popup-content');
      if (!content.contains(e.target)) closePopup();
    });

    popupClose.addEventListener('click', closePopup);

    // Buttons
    viewRequestBtn.addEventListener('click', showValentine);
    yesBtn.addEventListener('click', showPopup);

    // On load: always start fresh (no persistence) so refresh resets everything
    function init(){
      screen1.style.display = 'block';
      screen1.setAttribute('aria-hidden', 'false');
      screen2.style.display = 'none';
      screen2.setAttribute('aria-hidden', 'true');
      acceptedScreen.style.display = 'none';
      acceptedScreen.setAttribute('aria-hidden', 'true');
      acceptedInMemory = false;
      noClickIndex = 0;
      noBtn.textContent = noTexts[0];
      startHearts();
    }

    init();

    // Pause hearts on visibilitychange
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) stopHearts();
      else startHearts();
    });
  </script>
</body>
</html>
